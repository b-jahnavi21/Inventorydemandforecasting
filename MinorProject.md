Time Series Inventory Demand Forecasting on MVA data using ARIMA and
SARIMA
================
Akshitha, Jahnavi, Geetika, Navya Sree
2024-05-23

``` r
# Akshitha Thokala    - 160121771072
# Buggala Jahnavi     - 160121771075
# Guduru Geetika      - 160121771078
# Jamalpur Navya Sree - 160121771079
```

``` r
#necessary libraries
library(ggplot2)
library(tseries)
```

    ## Registered S3 method overwritten by 'quantmod':
    ##   method            from
    ##   as.zoo.data.frame zoo

``` r
library(dplyr)
```

    ## 
    ## Attaching package: 'dplyr'

    ## The following objects are masked from 'package:stats':
    ## 
    ##     filter, lag

    ## The following objects are masked from 'package:base':
    ## 
    ##     intersect, setdiff, setequal, union

``` r
library(forecast)
library(gam)
```

    ## Loading required package: splines

    ## Loading required package: foreach

    ## Loaded gam 1.22-3

``` r
#Overview of data
df=read.csv(file.choose())
head(df)
```

    ##   Year Month   New  Used Total.Sales.New Total.Sales.Used
    ## 1 2002   JAN 31106 49927       755015820        386481929
    ## 2 2002   FEB 27520 50982       664454223        361353242
    ## 3 2002   MAR 34225 58794       805666244        419385387
    ## 4 2002   APR 36452 59817       846368297        433061150
    ## 5 2002   MAY 37359 60577       855005784        442569410
    ## 6 2002   JUN 36348 55415       830251613        414731166

``` r
tail(df)
```

    ##     Year Month   New  Used Total.Sales.New Total.Sales.Used
    ## 261 2023   SEP 23892 45386      1134437699        744676584
    ## 262 2023   OCT 23775 45473      1122680147        740582533
    ## 263 2023   NOV 22720 42260      1062465105        694190564
    ## 264 2023   DEC 26010 40556      1233234965        674734577
    ## 265 2024   JAN 20034 40539       934569410        660638750
    ## 266 2024   FEB 22859 46445      1038745834        722221434

``` r
dim(df)
```

    ## [1] 266   6

``` r
str(df)
```

    ## 'data.frame':    266 obs. of  6 variables:
    ##  $ Year            : int  2002 2002 2002 2002 2002 2002 2002 2002 2002 2002 ...
    ##  $ Month           : chr  "JAN" "FEB" "MAR" "APR" ...
    ##  $ New             : int  31106 27520 34225 36452 37359 36348 30367 38965 39740 35276 ...
    ##  $ Used            : int  49927 50982 58794 59817 60577 55415 55235 60310 55485 58020 ...
    ##  $ Total.Sales.New : int  755015820 664454223 805666244 846368297 855005784 830251613 700530891 934484212 950502055 865326154 ...
    ##  $ Total.Sales.Used: int  386481929 361353242 419385387 433061150 442569410 414731166 384673023 455453720 432112270 456738532 ...

``` r
summary(df)
```

    ##       Year         Month                New             Used      
    ##  Min.   :2002   Length:266         Min.   :13700   Min.   :29420  
    ##  1st Qu.:2007   Class :character   1st Qu.:23761   1st Qu.:49963  
    ##  Median :2013   Mode  :character   Median :27686   Median :55978  
    ##  Mean   :2013                      Mean   :28077   Mean   :55337  
    ##  3rd Qu.:2018                      3rd Qu.:31455   3rd Qu.:60993  
    ##  Max.   :2024                      Max.   :45547   Max.   :73163  
    ##  Total.Sales.New     Total.Sales.Used   
    ##  Min.   :4.052e+08   Min.   :295521964  
    ##  1st Qu.:7.493e+08   1st Qu.:439916707  
    ##  Median :8.900e+08   Median :514263972  
    ##  Mean   :8.690e+08   Mean   :559729826  
    ##  3rd Qu.:9.874e+08   3rd Qu.:692850472  
    ##  Max.   :1.296e+09   Max.   :934785809

``` r
##############  PREPROCESSING #############################

#Converting Month to numeric value
months <- c("JAN", "FEB", "MAR", "APR", "MAY", "JUN", "JUL", "AUG", "SEP", "OCT", "NOV", "DEC")
convert_to_number <- function(month_abbr) {
  month_index <- match(month_abbr, months)
  if (is.na(month_index)) {
    return(NA)
  }
  if (month_index < 10) {
    return(paste0("0", month_index))
  } else {
    return(as.character(month_index))
  }
}

df$Month_Number <- lapply(df$Month, convert_to_number)
df$Month_Number <- unlist(df$Month_Number)
head(df)
```

    ##   Year Month   New  Used Total.Sales.New Total.Sales.Used Month_Number
    ## 1 2002   JAN 31106 49927       755015820        386481929           01
    ## 2 2002   FEB 27520 50982       664454223        361353242           02
    ## 3 2002   MAR 34225 58794       805666244        419385387           03
    ## 4 2002   APR 36452 59817       846368297        433061150           04
    ## 5 2002   MAY 37359 60577       855005784        442569410           05
    ## 6 2002   JUN 36348 55415       830251613        414731166           06

``` r
str(df)
```

    ## 'data.frame':    266 obs. of  7 variables:
    ##  $ Year            : int  2002 2002 2002 2002 2002 2002 2002 2002 2002 2002 ...
    ##  $ Month           : chr  "JAN" "FEB" "MAR" "APR" ...
    ##  $ New             : int  31106 27520 34225 36452 37359 36348 30367 38965 39740 35276 ...
    ##  $ Used            : int  49927 50982 58794 59817 60577 55415 55235 60310 55485 58020 ...
    ##  $ Total.Sales.New : int  755015820 664454223 805666244 846368297 855005784 830251613 700530891 934484212 950502055 865326154 ...
    ##  $ Total.Sales.Used: int  386481929 361353242 419385387 433061150 442569410 414731166 384673023 455453720 432112270 456738532 ...
    ##  $ Month_Number    : chr  "01" "02" "03" "04" ...

``` r
df<-subset(df,select=-c(Month))
head(df)
```

    ##   Year   New  Used Total.Sales.New Total.Sales.Used Month_Number
    ## 1 2002 31106 49927       755015820        386481929           01
    ## 2 2002 27520 50982       664454223        361353242           02
    ## 3 2002 34225 58794       805666244        419385387           03
    ## 4 2002 36452 59817       846368297        433061150           04
    ## 5 2002 37359 60577       855005784        442569410           05
    ## 6 2002 36348 55415       830251613        414731166           06

``` r
#Changing column names
colnames(df)[which(colnames(df) == "Month_Number")] <-"Month"
colnames(df)[which(colnames(df) == "New")] <-"New_Vehicles_Quantity"
colnames(df)[which(colnames(df) == "Used")] <-"Used_Vehicles_Quantity"
head(df)
```

    ##   Year New_Vehicles_Quantity Used_Vehicles_Quantity Total.Sales.New
    ## 1 2002                 31106                  49927       755015820
    ## 2 2002                 27520                  50982       664454223
    ## 3 2002                 34225                  58794       805666244
    ## 4 2002                 36452                  59817       846368297
    ## 5 2002                 37359                  60577       855005784
    ## 6 2002                 36348                  55415       830251613
    ##   Total.Sales.Used Month
    ## 1        386481929    01
    ## 2        361353242    02
    ## 3        419385387    03
    ## 4        433061150    04
    ## 5        442569410    05
    ## 6        414731166    06

``` r
str(df)
```

    ## 'data.frame':    266 obs. of  6 variables:
    ##  $ Year                  : int  2002 2002 2002 2002 2002 2002 2002 2002 2002 2002 ...
    ##  $ New_Vehicles_Quantity : int  31106 27520 34225 36452 37359 36348 30367 38965 39740 35276 ...
    ##  $ Used_Vehicles_Quantity: int  49927 50982 58794 59817 60577 55415 55235 60310 55485 58020 ...
    ##  $ Total.Sales.New       : int  755015820 664454223 805666244 846368297 855005784 830251613 700530891 934484212 950502055 865326154 ...
    ##  $ Total.Sales.Used      : int  386481929 361353242 419385387 433061150 442569410 414731166 384673023 455453720 432112270 456738532 ...
    ##  $ Month                 : chr  "01" "02" "03" "04" ...

``` r
#Finding null values
colnames(df)
```

    ## [1] "Year"                   "New_Vehicles_Quantity"  "Used_Vehicles_Quantity"
    ## [4] "Total.Sales.New"        "Total.Sales.Used"       "Month"

``` r
sum(is.na(df))
```

    ## [1] 0

``` r
df$Start_of_Month <- as.Date(paste(df$Year, df$Month, "01", sep = "-"))
head(df)
```

    ##   Year New_Vehicles_Quantity Used_Vehicles_Quantity Total.Sales.New
    ## 1 2002                 31106                  49927       755015820
    ## 2 2002                 27520                  50982       664454223
    ## 3 2002                 34225                  58794       805666244
    ## 4 2002                 36452                  59817       846368297
    ## 5 2002                 37359                  60577       855005784
    ## 6 2002                 36348                  55415       830251613
    ##   Total.Sales.Used Month Start_of_Month
    ## 1        386481929    01     2002-01-01
    ## 2        361353242    02     2002-02-01
    ## 3        419385387    03     2002-03-01
    ## 4        433061150    04     2002-04-01
    ## 5        442569410    05     2002-05-01
    ## 6        414731166    06     2002-06-01

``` r
sum(is.na(df$Start_of_Month))
```

    ## [1] 0

``` r
#converting to date class
df$Start_of_Month<-as.Date(df$Start_of_Month)
typeof(df$Start_of_Month)
```

    ## [1] "double"

``` r
class(df$Start_of_Month)
```

    ## [1] "Date"

``` r
str(df)
```

    ## 'data.frame':    266 obs. of  7 variables:
    ##  $ Year                  : int  2002 2002 2002 2002 2002 2002 2002 2002 2002 2002 ...
    ##  $ New_Vehicles_Quantity : int  31106 27520 34225 36452 37359 36348 30367 38965 39740 35276 ...
    ##  $ Used_Vehicles_Quantity: int  49927 50982 58794 59817 60577 55415 55235 60310 55485 58020 ...
    ##  $ Total.Sales.New       : int  755015820 664454223 805666244 846368297 855005784 830251613 700530891 934484212 950502055 865326154 ...
    ##  $ Total.Sales.Used      : int  386481929 361353242 419385387 433061150 442569410 414731166 384673023 455453720 432112270 456738532 ...
    ##  $ Month                 : chr  "01" "02" "03" "04" ...
    ##  $ Start_of_Month        : Date, format: "2002-01-01" "2002-02-01" ...

``` r
summary(df)
```

    ##       Year      New_Vehicles_Quantity Used_Vehicles_Quantity
    ##  Min.   :2002   Min.   :13700         Min.   :29420         
    ##  1st Qu.:2007   1st Qu.:23761         1st Qu.:49963         
    ##  Median :2013   Median :27686         Median :55978         
    ##  Mean   :2013   Mean   :28077         Mean   :55337         
    ##  3rd Qu.:2018   3rd Qu.:31455         3rd Qu.:60993         
    ##  Max.   :2024   Max.   :45547         Max.   :73163         
    ##  Total.Sales.New     Total.Sales.Used       Month          
    ##  Min.   :4.052e+08   Min.   :295521964   Length:266        
    ##  1st Qu.:7.493e+08   1st Qu.:439916707   Class :character  
    ##  Median :8.900e+08   Median :514263972   Mode  :character  
    ##  Mean   :8.690e+08   Mean   :559729826                     
    ##  3rd Qu.:9.874e+08   3rd Qu.:692850472                     
    ##  Max.   :1.296e+09   Max.   :934785809                     
    ##  Start_of_Month      
    ##  Min.   :2002-01-01  
    ##  1st Qu.:2007-07-08  
    ##  Median :2013-01-16  
    ##  Mean   :2013-01-15  
    ##  3rd Qu.:2018-07-24  
    ##  Max.   :2024-02-01

``` r
######################## Data visualization #################################


#Combined Analysis of new and used vehicles
new_df<-data.frame(Quantity_sold=c(df$New_Vehicles_Quantity+df$Used_Vehicles_Quantity),
                   Total.Sales=c(df$Total.Sales.New+df$Total.Sales.Used),
                   Start_of_Month=c(df$Start_of_Month))
new_df$Month<-df$Month
new_df$Year<-df$Year
head(new_df)
```

    ##   Quantity_sold Total.Sales Start_of_Month Month Year
    ## 1         81033  1141497749     2002-01-01    01 2002
    ## 2         78502  1025807465     2002-02-01    02 2002
    ## 3         93019  1225051631     2002-03-01    03 2002
    ## 4         96269  1279429447     2002-04-01    04 2002
    ## 5         97936  1297575194     2002-05-01    05 2002
    ## 6         91763  1244982779     2002-06-01    06 2002

``` r
summary(new_df)
```

    ##  Quantity_sold     Total.Sales        Start_of_Month          Month          
    ##  Min.   : 43120   Min.   :7.019e+08   Min.   :2002-01-01   Length:266        
    ##  1st Qu.: 74599   1st Qu.:1.197e+09   1st Qu.:2007-07-08   Class :character  
    ##  Median : 83175   Median :1.410e+09   Median :2013-01-16   Mode  :character  
    ##  Mean   : 83414   Mean   :1.429e+09   Mean   :2013-01-15                     
    ##  3rd Qu.: 93278   3rd Qu.:1.655e+09   3rd Qu.:2018-07-24                     
    ##  Max.   :115136   Max.   :2.138e+09   Max.   :2024-02-01                     
    ##       Year     
    ##  Min.   :2002  
    ##  1st Qu.:2007  
    ##  Median :2013  
    ##  Mean   :2013  
    ##  3rd Qu.:2018  
    ##  Max.   :2024

``` r
dim(new_df)
```

    ## [1] 266   5

``` r
#Line Chart
ggplot(new_df, aes(x = Month, y = Quantity_sold)) +
  geom_line() +
  labs(title = "Monthly Sales Over all Years", x = "Month", y = "Sales")
```

![](MinorProject_files/figure-gfm/unnamed-chunk-2-1.png)<!-- -->

``` r
#Bar chart
ggplot(new_df, aes(x = Month, y = Quantity_sold)) +
  geom_bar(stat = "identity") +
  labs(title = "Monthly Sales Over all Years", x = "Month", y = "Sales")
```

![](MinorProject_files/figure-gfm/unnamed-chunk-2-2.png)<!-- -->

``` r
#Box plot
ggplot(new_df, aes(x = Month, y = Quantity_sold)) +
  geom_boxplot() +
  labs(title = "Distribution of Monthly Sales", x = "Month", y = "Sales")
```

![](MinorProject_files/figure-gfm/unnamed-chunk-2-3.png)<!-- -->

``` r
#Cumulative sales
new_df$Cumulative_Sales <- cumsum(as.numeric(new_df$Total.Sales))

# Print the updated data frame
head(new_df)
```

    ##   Quantity_sold Total.Sales Start_of_Month Month Year Cumulative_Sales
    ## 1         81033  1141497749     2002-01-01    01 2002       1141497749
    ## 2         78502  1025807465     2002-02-01    02 2002       2167305214
    ## 3         93019  1225051631     2002-03-01    03 2002       3392356845
    ## 4         96269  1279429447     2002-04-01    04 2002       4671786292
    ## 5         97936  1297575194     2002-05-01    05 2002       5969361486
    ## 6         91763  1244982779     2002-06-01    06 2002       7214344265

``` r
#Area chart
ggplot(new_df, aes(x = Year, y = Cumulative_Sales,fill=Year)) +
  geom_area() +
  labs(title = "Cumulative Sales Over a Year", x = "Month", y = "Cumulative Sales")
```

![](MinorProject_files/figure-gfm/unnamed-chunk-2-4.png)<!-- -->

``` r
############################# Data modelling #####################################

# ----------------------------- NEW VEHICLES -------------------------------------

head(df)
```

    ##   Year New_Vehicles_Quantity Used_Vehicles_Quantity Total.Sales.New
    ## 1 2002                 31106                  49927       755015820
    ## 2 2002                 27520                  50982       664454223
    ## 3 2002                 34225                  58794       805666244
    ## 4 2002                 36452                  59817       846368297
    ## 5 2002                 37359                  60577       855005784
    ## 6 2002                 36348                  55415       830251613
    ##   Total.Sales.Used Month Start_of_Month
    ## 1        386481929    01     2002-01-01
    ## 2        361353242    02     2002-02-01
    ## 3        419385387    03     2002-03-01
    ## 4        433061150    04     2002-04-01
    ## 5        442569410    05     2002-05-01
    ## 6        414731166    06     2002-06-01

``` r
new_v = data.frame(df$Start_of_Month,df$New_Vehicles_Quantity)
head(new_v)
```

    ##   df.Start_of_Month df.New_Vehicles_Quantity
    ## 1        2002-01-01                    31106
    ## 2        2002-02-01                    27520
    ## 3        2002-03-01                    34225
    ## 4        2002-04-01                    36452
    ## 5        2002-05-01                    37359
    ## 6        2002-06-01                    36348

``` r
#To build arima and sarima model required attributes

new_v <- new_v %>%
  mutate(Sales_First_Difference = df.New_Vehicles_Quantity - lag(df.New_Vehicles_Quantity))
head(new_v)
```

    ##   df.Start_of_Month df.New_Vehicles_Quantity Sales_First_Difference
    ## 1        2002-01-01                    31106                     NA
    ## 2        2002-02-01                    27520                  -3586
    ## 3        2002-03-01                    34225                   6705
    ## 4        2002-04-01                    36452                   2227
    ## 5        2002-05-01                    37359                    907
    ## 6        2002-06-01                    36348                  -1011

``` r
new_v <- new_v %>%
  mutate(Seasonal_First_Difference = df.New_Vehicles_Quantity - lag(df.New_Vehicles_Quantity, 12))
head(new_v)
```

    ##   df.Start_of_Month df.New_Vehicles_Quantity Sales_First_Difference
    ## 1        2002-01-01                    31106                     NA
    ## 2        2002-02-01                    27520                  -3586
    ## 3        2002-03-01                    34225                   6705
    ## 4        2002-04-01                    36452                   2227
    ## 5        2002-05-01                    37359                    907
    ## 6        2002-06-01                    36348                  -1011
    ##   Seasonal_First_Difference
    ## 1                        NA
    ## 2                        NA
    ## 3                        NA
    ## 4                        NA
    ## 5                        NA
    ## 6                        NA

``` r
#seasonal first difference 
new_v$Seasonal_First_Difference <- c(rep(NA, 12), new_v$df.New_Vehicles_Quantity[13:nrow(new_v)] - new_v$df.New_Vehicles_Quantity[1:(nrow(new_v) - 12)])
print(new_v)
```

    ##     df.Start_of_Month df.New_Vehicles_Quantity Sales_First_Difference
    ## 1          2002-01-01                    31106                     NA
    ## 2          2002-02-01                    27520                  -3586
    ## 3          2002-03-01                    34225                   6705
    ## 4          2002-04-01                    36452                   2227
    ## 5          2002-05-01                    37359                    907
    ## 6          2002-06-01                    36348                  -1011
    ## 7          2002-07-01                    30367                  -5981
    ## 8          2002-08-01                    38965                   8598
    ## 9          2002-09-01                    39740                    775
    ## 10         2002-10-01                    35276                  -4464
    ## 11         2002-11-01                    27812                  -7464
    ## 12         2002-12-01                    26994                   -818
    ## 13         2003-01-01                    34707                   7713
    ## 14         2003-02-01                    24585                 -10122
    ## 15         2003-03-01                    32705                   8120
    ## 16         2003-04-01                    37682                   4977
    ## 17         2003-05-01                    38472                    790
    ## 18         2003-06-01                    38573                    101
    ## 19         2003-07-01                    41088                   2515
    ## 20         2003-08-01                    39556                  -1532
    ## 21         2003-09-01                    40464                    908
    ## 22         2003-10-01                    38597                  -1867
    ## 23         2003-11-01                    30155                  -8442
    ## 24         2003-12-01                    31668                   1513
    ## 25         2004-01-01                    33361                   1693
    ## 26         2004-02-01                    27780                  -5581
    ## 27         2004-03-01                    39340                  11560
    ## 28         2004-04-01                    37478                  -1862
    ## 29         2004-05-01                    37819                    341
    ## 30         2004-06-01                    42758                   4939
    ## 31         2004-07-01                    38329                  -4429
    ## 32         2004-08-01                    37175                  -1154
    ## 33         2004-09-01                    38712                   1537
    ## 34         2004-10-01                    34839                  -3873
    ## 35         2004-11-01                    29859                  -4980
    ## 36         2004-12-01                    31058                   1199
    ## 37         2005-01-01                    33637                   2579
    ## 38         2005-02-01                    26707                  -6930
    ## 39         2005-03-01                    35277                   8570
    ## 40         2005-04-01                    36609                   1332
    ## 41         2005-05-01                    36191                   -418
    ## 42         2005-06-01                    40674                   4483
    ## 43         2005-07-01                    38189                  -2485
    ## 44         2005-08-01                    45547                   7358
    ## 45         2005-09-01                    38909                  -6638
    ## 46         2005-10-01                    31392                  -7517
    ## 47         2005-11-01                    28915                  -2477
    ## 48         2005-12-01                    29787                    872
    ## 49         2006-01-01                    32331                   2544
    ## 50         2006-02-01                    25688                  -6643
    ## 51         2006-03-01                    34167                   8479
    ## 52         2006-04-01                    34099                    -68
    ## 53         2006-05-01                    36904                   2805
    ## 54         2006-06-01                    38718                   1814
    ## 55         2006-07-01                    36662                  -2056
    ## 56         2006-08-01                    37151                    489
    ## 57         2006-09-01                    35334                  -1817
    ## 58         2006-10-01                    33211                  -2123
    ## 59         2006-11-01                    28138                  -5073
    ## 60         2006-12-01                    26879                  -1259
    ## 61         2007-01-01                    31430                   4551
    ## 62         2007-02-01                    24793                  -6637
    ## 63         2007-03-01                    32862                   8069
    ## 64         2007-04-01                    33705                    843
    ## 65         2007-05-01                    34931                   1226
    ## 66         2007-06-01                    37333                   2402
    ## 67         2007-07-01                    33259                  -4074
    ## 68         2007-08-01                    35186                   1927
    ## 69         2007-09-01                    30248                  -4938
    ## 70         2007-10-01                    32965                   2717
    ## 71         2007-11-01                    27160                  -5805
    ## 72         2007-12-01                    24312                  -2848
    ## 73         2008-01-01                    29072                   4760
    ## 74         2008-02-01                    22819                  -6253
    ## 75         2008-03-01                    27118                   4299
    ## 76         2008-04-01                    30769                   3651
    ## 77         2008-05-01                    29035                  -1734
    ## 78         2008-06-01                    31463                   2428
    ## 79         2008-07-01                    29188                  -2275
    ## 80         2008-08-01                    25666                  -3522
    ## 81         2008-09-01                    26751                   1085
    ## 82         2008-10-01                    23216                  -3535
    ## 83         2008-11-01                    16842                  -6374
    ## 84         2008-12-01                    17220                    378
    ## 85         2009-01-01                    17963                    743
    ## 86         2009-02-01                    14779                  -3184
    ## 87         2009-03-01                    17844                   3065
    ## 88         2009-04-01                    20905                   3061
    ## 89         2009-05-01                    19781                  -1124
    ## 90         2009-06-01                    24509                   4728
    ## 91         2009-07-01                    22836                  -1673
    ## 92         2009-08-01                    25251                   2415
    ## 93         2009-09-01                    26992                   1741
    ## 94         2009-10-01                    20717                  -6275
    ## 95         2009-11-01                    18590                  -2127
    ## 96         2009-12-01                    18761                    171
    ## 97         2010-01-01                    20419                   1658
    ## 98         2010-02-01                    14809                  -5610
    ## 99         2010-03-01                    21920                   7111
    ## 100        2010-04-01                    25844                   3924
    ## 101        2010-05-01                    24383                  -1461
    ## 102        2010-06-01                    25850                   1467
    ## 103        2010-07-01                    23136                  -2714
    ## 104        2010-08-01                    23512                    376
    ## 105        2010-09-01                    24520                   1008
    ## 106        2010-10-01                    22003                  -2517
    ## 107        2010-11-01                    20551                  -1452
    ## 108        2010-12-01                    21075                    524
    ## 109        2011-01-01                    22239                   1164
    ## 110        2011-02-01                    18863                  -3376
    ## 111        2011-03-01                    27667                   8804
    ## 112        2011-04-01                    25793                  -1874
    ## 113        2011-05-01                    25464                   -329
    ## 114        2011-06-01                    26984                   1520
    ## 115        2011-07-01                    23154                  -3830
    ## 116        2011-08-01                    24875                   1721
    ## 117        2011-09-01                    24945                     70
    ## 118        2011-10-01                    22996                  -1949
    ## 119        2011-11-01                    22177                   -819
    ## 120        2011-12-01                    22512                    335
    ## 121        2012-01-01                    25223                   2711
    ## 122        2012-02-01                    21783                  -3440
    ## 123        2012-03-01                    28280                   6497
    ## 124        2012-04-01                    27467                   -813
    ## 125        2012-05-01                    29390                   1923
    ## 126        2012-06-01                    29662                    272
    ## 127        2012-07-01                    26593                  -3069
    ## 128        2012-08-01                    28765                   2172
    ## 129        2012-09-01                    26671                  -2094
    ## 130        2012-10-01                    27300                    629
    ## 131        2012-11-01                    22996                  -4304
    ## 132        2012-12-01                    22632                   -364
    ## 133        2013-01-01                    27083                   4451
    ## 134        2013-02-01                    21639                  -5444
    ## 135        2013-03-01                    29606                   7967
    ## 136        2013-04-01                    31273                   1667
    ## 137        2013-05-01                    32103                    830
    ## 138        2013-06-01                    31181                   -922
    ## 139        2013-07-01                    31348                    167
    ## 140        2013-08-01                    28407                  -2941
    ## 141        2013-09-01                    28654                    247
    ## 142        2013-10-01                    27106                  -1548
    ## 143        2013-11-01                    23235                  -3871
    ## 144        2013-12-01                    23574                    339
    ## 145        2014-01-01                    26792                   3218
    ## 146        2014-02-01                    20202                  -6590
    ## 147        2014-03-01                    25318                   5116
    ## 148        2014-04-01                    29820                   4502
    ## 149        2014-05-01                    31504                   1684
    ## 150        2014-06-01                    32620                   1116
    ## 151        2014-07-01                    33299                    679
    ## 152        2014-08-01                    30982                  -2317
    ## 153        2014-09-01                    32431                   1449
    ## 154        2014-10-01                    29250                  -3181
    ## 155        2014-11-01                    22582                  -6668
    ## 156        2014-12-01                    26419                   3837
    ## 157        2015-01-01                    28889                   2470
    ## 158        2015-02-01                    22430                  -6459
    ## 159        2015-03-01                    27428                   4998
    ## 160        2015-04-01                    32240                   4812
    ## 161        2015-05-01                    29626                  -2614
    ## 162        2015-06-01                    34695                   5069
    ## 163        2015-07-01                    34179                   -516
    ## 164        2015-08-01                    30125                  -4054
    ## 165        2015-09-01                    32154                   2029
    ## 166        2015-10-01                    30552                  -1602
    ## 167        2015-11-01                    25828                  -4724
    ## 168        2015-12-01                    29062                   3234
    ## 169        2016-01-01                    25835                  -3227
    ## 170        2016-02-01                    24257                  -1578
    ## 171        2016-03-01                    30675                   6418
    ## 172        2016-04-01                    29787                   -888
    ## 173        2016-05-01                    31525                   1738
    ## 174        2016-06-01                    34366                   2841
    ## 175        2016-07-01                    29636                  -4730
    ## 176        2016-08-01                    29945                    309
    ## 177        2016-09-01                    28544                  -1401
    ## 178        2016-10-01                    27082                  -1462
    ## 179        2016-11-01                    25381                  -1701
    ## 180        2016-12-01                    26205                    824
    ## 181        2017-01-01                    28827                   2622
    ## 182        2017-02-01                    22413                  -6414
    ## 183        2017-03-01                    27838                   5425
    ## 184        2017-04-01                    26135                  -1703
    ## 185        2017-05-01                    28931                   2796
    ## 186        2017-06-01                    31835                   2904
    ## 187        2017-07-01                    28331                  -3504
    ## 188        2017-08-01                    29644                   1313
    ## 189        2017-09-01                    28175                  -1469
    ## 190        2017-10-01                    27886                   -289
    ## 191        2017-11-01                    24970                  -2916
    ## 192        2017-12-01                    24944                    -26
    ## 193        2018-01-01                    28607                   3663
    ## 194        2018-02-01                    21448                  -7159
    ## 195        2018-03-01                    26914                   5466
    ## 196        2018-04-01                    26729                   -185
    ## 197        2018-05-01                    30967                   4238
    ## 198        2018-06-01                    31779                    812
    ## 199        2018-07-01                    30342                  -1437
    ## 200        2018-08-01                    30188                   -154
    ## 201        2018-09-01                    27180                  -3008
    ## 202        2018-10-01                    28879                   1699
    ## 203        2018-11-01                    24846                  -4033
    ## 204        2018-12-01                    26350                   1504
    ## 205        2019-01-01                    31090                   4740
    ## 206        2019-02-01                    21694                  -9396
    ## 207        2019-03-01                    26485                   4791
    ## 208        2019-04-01                    30044                   3559
    ## 209        2019-05-01                    29396                   -648
    ## 210        2019-06-01                    29142                   -254
    ## 211        2019-07-01                    30821                   1679
    ## 212        2019-08-01                    28399                  -2422
    ## 213        2019-09-01                    29591                   1192
    ## 214        2019-10-01                    28967                   -624
    ## 215        2019-11-01                    23573                  -5394
    ## 216        2019-12-01                    24839                   1266
    ## 217        2020-01-01                    27704                   2865
    ## 218        2020-02-01                    22344                  -5360
    ## 219        2020-03-01                    23873                   1529
    ## 220        2020-04-01                    13700                 -10173
    ## 221        2020-05-01                    14835                   1135
    ## 222        2020-06-01                    23704                   8869
    ## 223        2020-07-01                    26190                   2486
    ## 224        2020-08-01                    27372                   1182
    ## 225        2020-09-01                    27733                    361
    ## 226        2020-10-01                    24777                  -2956
    ## 227        2020-11-01                    25187                    410
    ## 228        2020-12-01                    28061                   2874
    ## 229        2021-01-01                    21674                  -6387
    ## 230        2021-02-01                    20579                  -1095
    ## 231        2021-03-01                    34794                  14215
    ## 232        2021-04-01                    32730                  -2064
    ## 233        2021-05-01                    33788                   1058
    ## 234        2021-06-01                    28039                  -5749
    ## 235        2021-07-01                    25779                  -2260
    ## 236        2021-08-01                    23233                  -2546
    ## 237        2021-09-01                    20975                  -2258
    ## 238        2021-10-01                    20843                   -132
    ## 239        2021-11-01                    20511                   -332
    ## 240        2021-12-01                    22677                   2166
    ## 241        2022-01-01                    19160                  -3517
    ## 242        2022-02-01                    21769                   2609
    ## 243        2022-03-01                    26148                   4379
    ## 244        2022-04-01                    23756                  -2392
    ## 245        2022-05-01                    23162                   -594
    ## 246        2022-06-01                    22954                   -208
    ## 247        2022-07-01                    22001                   -953
    ## 248        2022-08-01                    22594                    593
    ## 249        2022-09-01                    22941                    347
    ## 250        2022-10-01                    22255                   -686
    ## 251        2022-11-01                    21117                  -1138
    ## 252        2022-12-01                    23025                   1908
    ## 253        2023-01-01                    21037                  -1988
    ## 254        2023-02-01                    20893                   -144
    ## 255        2023-03-01                    28023                   7130
    ## 256        2023-04-01                    25918                  -2105
    ## 257        2023-05-01                    28372                   2454
    ## 258        2023-06-01                    27001                  -1371
    ## 259        2023-07-01                    26360                   -641
    ## 260        2023-08-01                    25876                   -484
    ## 261        2023-09-01                    23892                  -1984
    ## 262        2023-10-01                    23775                   -117
    ## 263        2023-11-01                    22720                  -1055
    ## 264        2023-12-01                    26010                   3290
    ## 265        2024-01-01                    20034                  -5976
    ## 266        2024-02-01                    22859                   2825
    ##     Seasonal_First_Difference
    ## 1                          NA
    ## 2                          NA
    ## 3                          NA
    ## 4                          NA
    ## 5                          NA
    ## 6                          NA
    ## 7                          NA
    ## 8                          NA
    ## 9                          NA
    ## 10                         NA
    ## 11                         NA
    ## 12                         NA
    ## 13                       3601
    ## 14                      -2935
    ## 15                      -1520
    ## 16                       1230
    ## 17                       1113
    ## 18                       2225
    ## 19                      10721
    ## 20                        591
    ## 21                        724
    ## 22                       3321
    ## 23                       2343
    ## 24                       4674
    ## 25                      -1346
    ## 26                       3195
    ## 27                       6635
    ## 28                       -204
    ## 29                       -653
    ## 30                       4185
    ## 31                      -2759
    ## 32                      -2381
    ## 33                      -1752
    ## 34                      -3758
    ## 35                       -296
    ## 36                       -610
    ## 37                        276
    ## 38                      -1073
    ## 39                      -4063
    ## 40                       -869
    ## 41                      -1628
    ## 42                      -2084
    ## 43                       -140
    ## 44                       8372
    ## 45                        197
    ## 46                      -3447
    ## 47                       -944
    ## 48                      -1271
    ## 49                      -1306
    ## 50                      -1019
    ## 51                      -1110
    ## 52                      -2510
    ## 53                        713
    ## 54                      -1956
    ## 55                      -1527
    ## 56                      -8396
    ## 57                      -3575
    ## 58                       1819
    ## 59                       -777
    ## 60                      -2908
    ## 61                       -901
    ## 62                       -895
    ## 63                      -1305
    ## 64                       -394
    ## 65                      -1973
    ## 66                      -1385
    ## 67                      -3403
    ## 68                      -1965
    ## 69                      -5086
    ## 70                       -246
    ## 71                       -978
    ## 72                      -2567
    ## 73                      -2358
    ## 74                      -1974
    ## 75                      -5744
    ## 76                      -2936
    ## 77                      -5896
    ## 78                      -5870
    ## 79                      -4071
    ## 80                      -9520
    ## 81                      -3497
    ## 82                      -9749
    ## 83                     -10318
    ## 84                      -7092
    ## 85                     -11109
    ## 86                      -8040
    ## 87                      -9274
    ## 88                      -9864
    ## 89                      -9254
    ## 90                      -6954
    ## 91                      -6352
    ## 92                       -415
    ## 93                        241
    ## 94                      -2499
    ## 95                       1748
    ## 96                       1541
    ## 97                       2456
    ## 98                         30
    ## 99                       4076
    ## 100                      4939
    ## 101                      4602
    ## 102                      1341
    ## 103                       300
    ## 104                     -1739
    ## 105                     -2472
    ## 106                      1286
    ## 107                      1961
    ## 108                      2314
    ## 109                      1820
    ## 110                      4054
    ## 111                      5747
    ## 112                       -51
    ## 113                      1081
    ## 114                      1134
    ## 115                        18
    ## 116                      1363
    ## 117                       425
    ## 118                       993
    ## 119                      1626
    ## 120                      1437
    ## 121                      2984
    ## 122                      2920
    ## 123                       613
    ## 124                      1674
    ## 125                      3926
    ## 126                      2678
    ## 127                      3439
    ## 128                      3890
    ## 129                      1726
    ## 130                      4304
    ## 131                       819
    ## 132                       120
    ## 133                      1860
    ## 134                      -144
    ## 135                      1326
    ## 136                      3806
    ## 137                      2713
    ## 138                      1519
    ## 139                      4755
    ## 140                      -358
    ## 141                      1983
    ## 142                      -194
    ## 143                       239
    ## 144                       942
    ## 145                      -291
    ## 146                     -1437
    ## 147                     -4288
    ## 148                     -1453
    ## 149                      -599
    ## 150                      1439
    ## 151                      1951
    ## 152                      2575
    ## 153                      3777
    ## 154                      2144
    ## 155                      -653
    ## 156                      2845
    ## 157                      2097
    ## 158                      2228
    ## 159                      2110
    ## 160                      2420
    ## 161                     -1878
    ## 162                      2075
    ## 163                       880
    ## 164                      -857
    ## 165                      -277
    ## 166                      1302
    ## 167                      3246
    ## 168                      2643
    ## 169                     -3054
    ## 170                      1827
    ## 171                      3247
    ## 172                     -2453
    ## 173                      1899
    ## 174                      -329
    ## 175                     -4543
    ## 176                      -180
    ## 177                     -3610
    ## 178                     -3470
    ## 179                      -447
    ## 180                     -2857
    ## 181                      2992
    ## 182                     -1844
    ## 183                     -2837
    ## 184                     -3652
    ## 185                     -2594
    ## 186                     -2531
    ## 187                     -1305
    ## 188                      -301
    ## 189                      -369
    ## 190                       804
    ## 191                      -411
    ## 192                     -1261
    ## 193                      -220
    ## 194                      -965
    ## 195                      -924
    ## 196                       594
    ## 197                      2036
    ## 198                       -56
    ## 199                      2011
    ## 200                       544
    ## 201                      -995
    ## 202                       993
    ## 203                      -124
    ## 204                      1406
    ## 205                      2483
    ## 206                       246
    ## 207                      -429
    ## 208                      3315
    ## 209                     -1571
    ## 210                     -2637
    ## 211                       479
    ## 212                     -1789
    ## 213                      2411
    ## 214                        88
    ## 215                     -1273
    ## 216                     -1511
    ## 217                     -3386
    ## 218                       650
    ## 219                     -2612
    ## 220                    -16344
    ## 221                    -14561
    ## 222                     -5438
    ## 223                     -4631
    ## 224                     -1027
    ## 225                     -1858
    ## 226                     -4190
    ## 227                      1614
    ## 228                      3222
    ## 229                     -6030
    ## 230                     -1765
    ## 231                     10921
    ## 232                     19030
    ## 233                     18953
    ## 234                      4335
    ## 235                      -411
    ## 236                     -4139
    ## 237                     -6758
    ## 238                     -3934
    ## 239                     -4676
    ## 240                     -5384
    ## 241                     -2514
    ## 242                      1190
    ## 243                     -8646
    ## 244                     -8974
    ## 245                    -10626
    ## 246                     -5085
    ## 247                     -3778
    ## 248                      -639
    ## 249                      1966
    ## 250                      1412
    ## 251                       606
    ## 252                       348
    ## 253                      1877
    ## 254                      -876
    ## 255                      1875
    ## 256                      2162
    ## 257                      5210
    ## 258                      4047
    ## 259                      4359
    ## 260                      3282
    ## 261                       951
    ## 262                      1520
    ## 263                      1603
    ## 264                      2985
    ## 265                     -1003
    ## 266                      1966

``` r
#seasonal first difference plot
new_v$Seasonal_First_Difference <- c(rep(NA, 12), new_v$df.New_Vehicles_Quantity[13:nrow(df)] - new_v$df.New_Vehicles_Quantity[1:(nrow(new_v) - 12)])
plot(new_v$Seasonal_First_Difference, type = "l", xlab = "Time", ylab = "Seasonal First Difference", main = "Seasonal First Difference Plot")
```

![](MinorProject_files/figure-gfm/unnamed-chunk-2-5.png)<!-- -->

``` r
## Impute missing values with mean
new_v$df.New_Vehicles_Quantity[is.na(new_v$df.New_Vehicles_Quantity)] <- mean(df$df.New_Vehicles_Quantity, na.rm = TRUE) 
```

    ## Warning in mean.default(df$df.New_Vehicles_Quantity, na.rm = TRUE): argument is
    ## not numeric or logical: returning NA

``` r
## Convert data to time series object
ts_data <- ts(new_v$df.New_Vehicles_Quantity)

# Replace missing values with the mean of existing values
new_v$Seasonal_First_Difference[is.na(new_v$Seasonal_First_Difference)] <- mean(new_v$Seasonal_First_Difference, na.rm = TRUE)


# Plot the autocorrelation and partial autocorrelation
par(mfrow = c(2, 1))  # Set up a 2x1 grid of plots
acf(new_v$Seasonal_First_Difference, lag.max = 40, main = "Autocorrelation Plot")
pacf(new_v$Seasonal_First_Difference, lag.max = 40, main = "Partial Autocorrelation Plot")
```

![](MinorProject_files/figure-gfm/unnamed-chunk-2-6.png)<!-- -->

``` r
new_v$df.New_Vehicles_Quantity[is.na(new_v$df.New_Vehicles_Quantity)] <- mean(df$df.New_Vehicles_Quantity, na.rm = TRUE)
```

    ## Warning in mean.default(df$df.New_Vehicles_Quantity, na.rm = TRUE): argument is
    ## not numeric or logical: returning NA

``` r
#Training and testing data
tail(new_v,20)
```

    ##     df.Start_of_Month df.New_Vehicles_Quantity Sales_First_Difference
    ## 247        2022-07-01                    22001                   -953
    ## 248        2022-08-01                    22594                    593
    ## 249        2022-09-01                    22941                    347
    ## 250        2022-10-01                    22255                   -686
    ## 251        2022-11-01                    21117                  -1138
    ## 252        2022-12-01                    23025                   1908
    ## 253        2023-01-01                    21037                  -1988
    ## 254        2023-02-01                    20893                   -144
    ## 255        2023-03-01                    28023                   7130
    ## 256        2023-04-01                    25918                  -2105
    ## 257        2023-05-01                    28372                   2454
    ## 258        2023-06-01                    27001                  -1371
    ## 259        2023-07-01                    26360                   -641
    ## 260        2023-08-01                    25876                   -484
    ## 261        2023-09-01                    23892                  -1984
    ## 262        2023-10-01                    23775                   -117
    ## 263        2023-11-01                    22720                  -1055
    ## 264        2023-12-01                    26010                   3290
    ## 265        2024-01-01                    20034                  -5976
    ## 266        2024-02-01                    22859                   2825
    ##     Seasonal_First_Difference
    ## 247                     -3778
    ## 248                      -639
    ## 249                      1966
    ## 250                      1412
    ## 251                       606
    ## 252                       348
    ## 253                      1877
    ## 254                      -876
    ## 255                      1875
    ## 256                      2162
    ## 257                      5210
    ## 258                      4047
    ## 259                      4359
    ## 260                      3282
    ## 261                       951
    ## 262                      1520
    ## 263                      1603
    ## 264                      2985
    ## 265                     -1003
    ## 266                      1966

``` r
train_df<-new_v[1:252,]
tail(train_df,1)
```

    ##     df.Start_of_Month df.New_Vehicles_Quantity Sales_First_Difference
    ## 252        2022-12-01                    23025                   1908
    ##     Seasonal_First_Difference
    ## 252                       348

``` r
test_df<-new_v[253:266,]
print(test_df)
```

    ##     df.Start_of_Month df.New_Vehicles_Quantity Sales_First_Difference
    ## 253        2023-01-01                    21037                  -1988
    ## 254        2023-02-01                    20893                   -144
    ## 255        2023-03-01                    28023                   7130
    ## 256        2023-04-01                    25918                  -2105
    ## 257        2023-05-01                    28372                   2454
    ## 258        2023-06-01                    27001                  -1371
    ## 259        2023-07-01                    26360                   -641
    ## 260        2023-08-01                    25876                   -484
    ## 261        2023-09-01                    23892                  -1984
    ## 262        2023-10-01                    23775                   -117
    ## 263        2023-11-01                    22720                  -1055
    ## 264        2023-12-01                    26010                   3290
    ## 265        2024-01-01                    20034                  -5976
    ## 266        2024-02-01                    22859                   2825
    ##     Seasonal_First_Difference
    ## 253                      1877
    ## 254                      -876
    ## 255                      1875
    ## 256                      2162
    ## 257                      5210
    ## 258                      4047
    ## 259                      4359
    ## 260                      3282
    ## 261                       951
    ## 262                      1520
    ## 263                      1603
    ## 264                      2985
    ## 265                     -1003
    ## 266                      1966

``` r
#----------------------------------------------ARIMA----------------------------------------------------------------
model <- Arima(train_df$df.New_Vehicles_Quantity, order = c(3, 1, 2))
# Make forecasts
forecast_values1 <- forecast(model, h = 14, dynamic = TRUE)
```

    ## Warning in forecast.forecast_ARIMA(model, h = 14, dynamic = TRUE): The
    ## non-existent dynamic arguments will be ignored.

``` r
forecast_values1[4]
```

    ## $mean
    ## Time Series:
    ## Start = 253 
    ## End = 266 
    ## Frequency = 1 
    ##  [1] 22539.22 22327.67 22827.87 22360.00 22644.56 22554.61 22513.63 22606.50
    ##  [9] 22520.40 22572.34 22556.28 22548.39 22565.63 22549.79

``` r
predicted_values1<-c(22508.66, 22306.12, 22831.39, 22359.26, 22623.72, 22558.46, 22505.64, 22593.01, 22523.39, 22557.77, 22553.13,
                     22542.12, 22556.15, 22546.15)
accuracy(test_df$df.New_Vehicles_Quantity,predicted_values1)
```

    ##                 ME     RMSE      MAE       MPE     MAPE
    ## Test set -1943.216 3207.814 2715.635 -8.595923 12.03235

``` r
# Plot the forecasts along with the actual sales data
plot(forecast_values1, main = "Sales Forecast from Arima")
lines(df$New_Vehicles_Quantity, col = "red")



#----------------------------------------------SARIMA-------------------------------------------------------------------
model2 <- arima(train_df$df.New_Vehicles_Quantity, order = c(2, 1, 3), seasonal = list(order = c(2, 1, 3), period = 12))

# Print the model summary
summary(model2)
```

    ## 
    ## Call:
    ## arima(x = train_df$df.New_Vehicles_Quantity, order = c(2, 1, 3), seasonal = list(order = c(2, 
    ##     1, 3), period = 12))
    ## 
    ## Coefficients:
    ##           ar1     ar2     ma1      ma2     ma3     sar1     sar2     sma1
    ##       -0.3437  0.5008  0.0375  -0.8717  0.0908  -0.6120  -0.7392  -0.1116
    ## s.e.   0.1945  0.1619  0.2170   0.0912  0.1500   0.1791   0.1631   0.1675
    ##         sma2     sma3
    ##       0.3050  -0.7714
    ## s.e.  0.1507   0.1541
    ## 
    ## sigma^2 estimated as 5817524:  log likelihood = -2213.4,  aic = 4448.79
    ## 
    ## Training set error measures:
    ##                     ME     RMSE      MAE        MPE     MAPE      MASE
    ## Training set -69.16665 2348.927 1685.574 -0.6249755 6.439169 0.5547917
    ##                     ACF1
    ## Training set 0.007087839

``` r
forecast_values <- forecast(model2, h = 14, dynamic = TRUE)
```

    ## Warning in forecast.Arima(model2, h = 14, dynamic = TRUE): The non-existent
    ## dynamic arguments will be ignored.

``` r
# Accuracy of Sarima

predicted_values<-c(21657.80, 18706.90, 25264.67, 26414.12, 26617.36, 25797.82, 24431.42, 23965.55, 23238.43, 22459.76, 19258.11,
                    20899.36, 21610.99, 17864.31)

accuracy(test_df$df.New_Vehicles_Quantity,predicted_values)
```

    ##                 ME     RMSE      MAE       MPE     MAPE
    ## Test set -1755.957 2571.947 2140.801 -8.338628 10.05889

``` r
# Plot the forecasts along with the actual sales data
plot(forecast_values, main = "Sales Forecast from Sarima")
lines(df$New_Vehicles_Quantity, col = "red")
```

![](MinorProject_files/figure-gfm/unnamed-chunk-2-7.png)<!-- -->

``` r
# Set up the plot area
par(mar = c(5, 5, 4, 2) + 0.1)  # Adjust margins to provide space for labels

#----------------------- Forecast values-----------------------------------------

future_dates <- seq(as.Date("2024-03-01"), by = "month", length.out = 204)
future_df <- data.frame(Date = future_dates)
future_df$forecast <- forecast(model2, h = 204)$mean

head(future_df)
```

    ##         Date forecast
    ## 1 2024-03-01 21657.80
    ## 2 2024-04-01 18706.90
    ## 3 2024-05-01 25264.67
    ## 4 2024-06-01 26414.12
    ## 5 2024-07-01 26617.36
    ## 6 2024-08-01 25797.82

``` r
plot(future_df$Date, future_df$forecast, type = "l", xlab = "Date", ylab = "Forecast", main = "Forecasted Sales", xlim = range(future_df$Date), xaxt = "n", col = "red", lwd = 2)
axis.Date(1, at = future_df$Date, labels = format(future_df$Date, "%Y-%m"), cex.axis = 0.7, las = 2)
grid(col = "lightgray", lwd = 0.5)
legend("topright", legend = "Forecast", col = "red", lty = 1, lwd = 2, cex = 0.8)

#------------------- GAM model --------------------------------

new_vehicles<-subset(df,select=c(New_Vehicles_Quantity, Total.Sales.New))

head(new_vehicles)
```

    ##   New_Vehicles_Quantity Total.Sales.New
    ## 1                 31106       755015820
    ## 2                 27520       664454223
    ## 3                 34225       805666244
    ## 4                 36452       846368297
    ## 5                 37359       855005784
    ## 6                 36348       830251613

``` r
train_df_v<-new_vehicles[1:252,]
test_df_v<-new_vehicles[253:266,]
gam_model <- gam(Total.Sales.New ~ s(New_Vehicles_Quantity), data = train_df_v)
summary(gam_model)
```

    ## 
    ## Call: gam(formula = Total.Sales.New ~ s(New_Vehicles_Quantity), data = train_df_v)
    ## Deviance Residuals:
    ##        Min         1Q     Median         3Q        Max 
    ## -216804090  -90893424  -26002332   78455113  374565241 
    ## 
    ## (Dispersion Parameter for gaussian family taken to be 1.547536e+16)
    ## 
    ##     Null Deviance: 6.661246e+18 on 251 degrees of freedom
    ## Residual Deviance: 3.822417e+18 on 247.0002 degrees of freedom
    ## AIC: 10116.16 
    ## 
    ## Number of Local Scoring Iterations: NA 
    ## 
    ## Anova for Parametric Effects
    ##                           Df     Sum Sq    Mean Sq F value    Pr(>F)    
    ## s(New_Vehicles_Quantity)   1 2.3525e+18 2.3525e+18  152.01 < 2.2e-16 ***
    ## Residuals                247 3.8224e+18 1.5475e+16                      
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Anova for Nonparametric Effects
    ##                          Npar Df Npar F     Pr(F)    
    ## (Intercept)                                          
    ## s(New_Vehicles_Quantity)       3 10.476 1.641e-06 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

``` r
predictions <- predict(gam_model, newdata = test_df_v, type = "response")
accuracy(predictions,test_df_v$New_Vehicles_Quantity)
```

    ##                  ME      RMSE       MAE      MPE    MAPE
    ## Test set -801255957 803794627 801255957 -3282228 3282228

``` r
#------------------------------------------------------------------------------

names(future_df)[names(future_df) == "forecast"] <- "New_Vehicles_Quantity"

predictions_f <- predict(gam_model, newdata = future_df, type = "response")

future_df$Total.Amount<-predictions_f

head(future_df)
```

    ##         Date New_Vehicles_Quantity Total.Amount
    ## 1 2024-03-01              21657.80    735626475
    ## 2 2024-04-01              18706.90    623012799
    ## 3 2024-05-01              25264.67    824557872
    ## 4 2024-06-01              26414.12    848249654
    ## 5 2024-07-01              26617.36    852407982
    ## 6 2024-08-01              25797.82    835566978

![](MinorProject_files/figure-gfm/unnamed-chunk-2-8.png)<!-- -->
